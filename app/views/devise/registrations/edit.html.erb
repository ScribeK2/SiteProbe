<div class="max-w-md mx-auto">
  <div class="sticky-card tape-top p-8 pt-12">
    <div class="absolute bottom-0 left-0 right-0 h-3 stripes-purple rounded-b-sm"></div>
    
    <div class="text-center mb-8">
      <div class="w-16 h-16 mx-auto mb-4 bg-retro-purple rounded-xl flex items-center justify-center">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
        </svg>
      </div>
      <h1 class="text-3xl font-extrabold tracking-tight mb-2">Account Settings</h1>
      <p class="text-gray-600">Update your email or password</p>
    </div>

    <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put, class: "space-y-6" }) do |f| %>
      <%= render "devise/shared/error_messages", resource: resource %>

      <div>
        <label class="block text-sm font-bold text-gray-700 mb-2">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
            Email
          </span>
        </label>
        <%= f.email_field :email, autofocus: true, autocomplete: "email",
            class: "w-full text-lg font-mono border-2 border-gray-200 focus:border-black rounded-lg px-4 py-3 bg-cream placeholder:text-gray-400 transition-colors" %>
      </div>

      <% if devise_mapping.confirmable? && resource.pending_reconfirmation? %>
        <div class="p-4 bg-retro-orange-light border-l-4 border-retro-orange rounded-r-lg">
          <div class="flex items-center gap-2 text-sm">
            <svg class="w-4 h-4 text-retro-orange" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span class="font-semibold text-orange-800">Waiting confirmation for: <%= resource.unconfirmed_email %></span>
          </div>
        </div>
      <% end %>

      <div>
        <label class="block text-sm font-bold text-gray-700 mb-2">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
            </svg>
            New Password
          </span>
          <span class="font-normal text-gray-500 ml-2">(leave blank if unchanged)</span>
        </label>
        <%= f.password_field :password, autocomplete: "new-password",
            class: "w-full text-lg border-2 border-gray-200 focus:border-black rounded-lg px-4 py-3 bg-cream placeholder:text-gray-400 transition-colors",
            placeholder: "••••••••" %>
        <% if @minimum_password_length %>
          <div class="text-xs text-gray-500 mt-1"><%= @minimum_password_length %> characters minimum</div>
        <% end %>
      </div>

      <div>
        <label class="block text-sm font-bold text-gray-700 mb-2">Confirm New Password</label>
        <%= f.password_field :password_confirmation, autocomplete: "new-password",
            class: "w-full text-lg border-2 border-gray-200 focus:border-black rounded-lg px-4 py-3 bg-cream placeholder:text-gray-400 transition-colors",
            placeholder: "••••••••" %>
      </div>

      <hr class="border-gray-200">

      <div>
        <label class="block text-sm font-bold text-gray-700 mb-2">
          <span class="flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
            </svg>
            Current Password
          </span>
          <span class="font-normal text-gray-500 ml-2">(required to save changes)</span>
        </label>
        <%= f.password_field :current_password, autocomplete: "current-password",
            class: "w-full text-lg border-2 border-gray-200 focus:border-black rounded-lg px-4 py-3 bg-cream placeholder:text-gray-400 transition-colors",
            placeholder: "••••••••" %>
      </div>

      <div class="pt-2">
        <%= f.submit "Update Account →", class: "btn-retro w-full justify-center text-lg py-4 cursor-pointer" %>
      </div>
    <% end %>
  </div>

  <%# Danger Zone %>
  <div class="mt-8 sticky-card p-6 rotate-subtle-right">
    <div class="absolute bottom-0 left-0 right-0 h-3 stripes-red rounded-b-sm"></div>
    
    <div class="flex items-center gap-3 mb-4">
      <div class="w-10 h-10 bg-retro-red rounded-lg flex items-center justify-center">
        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
        </svg>
      </div>
      <div>
        <h3 class="font-bold text-red-800">Danger Zone</h3>
        <p class="text-sm text-gray-600">Permanently delete your account</p>
      </div>
    </div>
    
    <%= button_to "Delete my account", registration_path(resource_name), 
        method: :delete,
        data: { turbo_confirm: "Are you sure? This action cannot be undone." },
        class: "w-full py-3 px-4 border-2 border-retro-red text-retro-red font-bold rounded-lg hover:bg-retro-red hover:text-white transition-colors cursor-pointer" %>
  </div>

  <div class="mt-6 text-center">
    <%= link_to "← Back to Dashboard", dashboard_path, class: "text-sm font-semibold text-gray-500 hover:text-black" %>
  </div>
</div>
